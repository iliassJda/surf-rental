(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[169],{9192:(e,r,t)=>{Promise.resolve().then(t.bind(t,73004))},29523:(e,r,t)=>{"use strict";t.d(r,{U:()=>a});var s=t(16620);function a(){return(0,s.createBrowserClient)("https://crejvlwlntwyezdtfofb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNyZWp2bHdsbnR3eWV6ZHRmb2ZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NjIwMzUsImV4cCI6MjA3NDQzODAzNX0.ut1DvOMlPcAz-DoOCyQMWgbQGLWca24u_LOunInrrTU")}},47647:(e,r,t)=>{"use strict";t.d(r,{K:()=>c});var s=t(51012),a=t(16836),n=t(8678),i=t(99794),l=t(17974),o=t(97282),d=t(12115);function c(){let{isConnected:e,account:r}=(0,o.v)(),t=async function(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(!e||r){let e=new a.FR("http://127.0.0.1:8545/");return new n.NZ(l.m,l.A,e)}let t=(()=>{if(window.ethereum)return new s.k(window.ethereum);throw Error("Ethereum provider not found")})(),i=await t.getSigner();return new n.NZ(l.m,l.A,i)}catch(e){throw console.error("Failed to init contract",e),Error("Failed to initialize contract")}},c=async(e,r,s)=>{let a=await t(),n=i.g5(r),l=i.g5(s),o=await a.rentBoard(e,{value:n+l});await o.wait()};return{withdraw:async()=>{try{let e=await t(),r=await e.withdraw();return{receipt:await r.wait(),contract:e}}catch(e){console.error(e)}},getPendingWithdrawals:async e=>{try{let r=await t();return await r.pendingWithdrawals(e)}catch(e){console.error(e)}},returnDeposit:async(e,r)=>{try{let s=await t(),a=await s.returnDeposit(e.id,r);return{receipt:await a.wait(),contract:s}}catch(e){return{errorMessage:e}}},returnBoard:async e=>{try{let r=await t(),s=await r.returnBoard(e.id);return{receipt:await s.wait(),contract:r}}catch(e){return{errorMessage:e}}},rentBoard:c,listBoard:async(e,r,s)=>{let a,n,l=Number(r),o=Number(s);if(!Number.isFinite(l)||!Number.isFinite(o)||l<0||o<0)return{message:"Price and deposit must be valid positive numbers."};try{a=i.g5(r),n=i.g5(s)}catch(e){return console.error("Failed to parse ETH amounts:",e),{message:"Invalid number format. Use a dot for decimals, e.g., 2.12"}}let d=await t(),c=await d.listBoard(e,a,n);return{receipt:await c.wait(),contract:d}},getAllBoards:(0,d.useCallback)(async()=>{let e=await t(!0),r=await e.nextBoardId(),s=[];console.log("The next board id is: ",r);for(let t=0;t<Number(r);t++)try{let r=await e.boards(t),a={id:Number(r.id),description:r.description,owner:r.owner,renter:r.renter,pricePerDay:r.pricePerDay,deposit:r.deposit,status:Number(r.available)};console.log("board status = ",a.status),s.push(a)}catch(e){console.error("Failed to fetch board ".concat(t,":"),e)}return s},[e]),resetBoards:async()=>{try{let e=await t(),r=await e.resetBoards();return{receipt:await r.wait(),contract:e}}catch(e){return{errorMessage:e}}}}}},73004:(e,r,t)=>{"use strict";t.d(r,{default:()=>b});var s=t(95155),a=t(12115),n=t(29523),i=t(97282),l=t(85388),o=t(69492),d=t(140),c=t(19876),u=t(96423),m=t(63066),x=t(33099),h=t(20063),p=t(47647),f=t(4256),g=t(64831),w=(0,t(55657).Rf)((e,r)=>{let{Component:t,children:n,startContent:i,endContent:l,thumbIcon:o,getBaseProps:d,getInputProps:c,getWrapperProps:u,getThumbProps:m,getThumbIconProps:x,getLabelProps:h,getStartContentProps:p,getEndContentProps:f}=(0,g.K)({...e,ref:r}),w="function"==typeof o?o(x({includeStateProps:!0})):o&&(0,a.cloneElement)(o,x()),b=i&&(0,a.cloneElement)(i,p()),j=l&&(0,a.cloneElement)(l,f());return(0,s.jsxs)(t,{...d(),children:[(0,s.jsx)("input",{...c()}),(0,s.jsxs)("span",{...u(),children:[i&&b,(0,s.jsx)("span",{...m(),children:o&&w}),l&&j]}),n&&(0,s.jsx)("span",{...h(),children:n})]})});function b(){let[e,r]=(0,a.useState)([]),[t,g]=(0,a.useState)(!0),[b,j]=(0,a.useState)(null),[N,y]=(0,a.useState)(!0),[v,I]=(0,a.useState)(null),[D,E]=(0,a.useState)(!1),k=(0,n.U)(),{isOpen:C,onOpen:B,onOpenChange:P}=(0,o.j)();(0,h.useRouter)();let{isConnected:S,account:U,balance:z,connectWallet:F,isLoading:O}=(0,i.v)(),{returnDeposit:T}=(0,p.K)();(0,a.useEffect)(()=>{let e=async()=>{try{let e;g(!0),j(null);let{data:t,error:s}=await k.from("Boards").select("*").eq("status",1);e=(null==t?void 0:t.filter(e=>e.owner===U))||[],s?(console.error("Fetch error:",s),j("Error fetching boards: ".concat(s.message))):r(e)}catch(e){console.error("Unexpected error:",e),j("An unexpected error occurred")}finally{g(!1)}};U&&e()},[k,U]);let R=async()=>{if(v){E(!0);try{await T(v,N);let{error:e}=await k.from("Boards").update({status:0,renter:null}).eq("id",v.id);e&&(console.error("Error updating database:",e),(0,f.$U)({title:"Error Updating SUPABASE",description:"Unexpected error has occured while updating the database",color:"danger"})),P(),I(null),y(!0)}catch(e){console.error("Deposit failed:",e)}finally{E(!1),(0,f.$U)({title:N?"Deposit returned":"Deposit Kept",description:N?"Deposit returned succesfully":"Deposit is kept due to the condition of the board",color:N?"success":"danger"})}}};return S?t?(0,s.jsx)("div",{className:"w-full text-center",children:(0,s.jsx)("p",{children:"Loading your boards..."})}):b?(0,s.jsxs)("div",{className:"w-full text-center text-danger",children:[(0,s.jsx)("p",{children:b}),(0,s.jsx)(l.T,{onPress:()=>window.location.reload(),color:"primary",variant:"bordered",className:"mt-2",children:"Retry"})]}):0===e.length?(0,s.jsx)("div",{className:"w-full text-center",children:(0,s.jsx)("p",{className:"text-default-600",children:"No returnals yet"})}):(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Returned Boards"}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 mb-8",children:e.map((e,r)=>(0,s.jsx)("div",{className:"border border-default-200 rounded-lg",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h3",{className:"font-bold text-lg text-foreground mb-3 pr-16",children:e.description}),(0,s.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 ".concat(N?"bg-primary-100":"bg-danger-100"," rounded-lg"),children:[(0,s.jsx)("span",{className:"text-sm font-medium text-default-600",children:"Deposit Paid"}),(0,s.jsxs)("span",{className:"font-bold text-primary-500",children:[e.deposit," ETH"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-default-50 rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-default-600",children:"renter"}),(0,s.jsxs)("span",{className:"font-mono text-sm text-foreground",children:[e.renter.slice(0,6),"...",e.renter.slice(-4)]})]}),(0,s.jsx)(w,{isSelected:N,onValueChange:y,children:"Board Condition"}),(0,s.jsxs)("p",{className:"text-small text-default-500",children:["Selected: ",N?"Good condition":"Kapoot"]})]}),(0,s.jsx)(l.T,{color:"".concat(N?"primary":"danger"),variant:"shadow",className:"w-full font-medium group-hover:scale-105 transition-transform",size:"lg",onPress:()=>{I(e),B()},children:"Confirm returnal"})]})},r))}),(0,s.jsx)(d.Y,{isOpen:C,onOpenChange:P,backdrop:"blur",size:"lg",children:(0,s.jsx)(c.g,{children:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(u.c,{className:"flex flex-col gap-1 pb-2",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Confirm the returnal"}),(0,s.jsx)("p",{className:"text-sm text-default-500",children:"Confirm returnal and send deposit"})]}),(0,s.jsx)(m.h,{className:"py-6",children:v&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-primary-200 to-secondary-200 p-6 rounded-lg ",children:(0,s.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-foreground mb-1",children:v.description}),(0,s.jsxs)("p",{className:"text-sm text-default-600 flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-block w-2 h-2 bg-primary rounded-full"}),"Renter: ",v.renter.slice(0,6),"...",v.renter.slice(-4)]})]})})}),(0,s.jsxs)("div",{className:"bg-default-100 p-6 rounded-xl space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center gap-3 mb-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-foreground",children:"Deposit Return Information"}),(0,s.jsx)("p",{className:"text-sm text-default-600",children:"Your security deposit details"})]})}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,s.jsxs)("div",{className:"dark:bg-default-200 p-4 rounded-lg border border-default-200 dark:border-default-100",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-default-500 dark:text-default-500 mb-1",children:"Security Deposit"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-primary",children:[v.deposit," ETH"]})]})})]}),N?null:(0,s.jsx)("div",{className:"border bg-danger-50 border-danger-200 rounded-xl p-4",children:(0,s.jsx)("div",{className:"flex items-start gap-3",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"font-semibold text-danger-800 dark:text-danger-400 mb-1",children:"Keep Deposit due too questionable condition"}),(0,s.jsx)("p",{className:"text-sm text-danger-700 dark:text-danger-300 ",children:"You will keep the deposit bedause you think that the board's condition is not good enough to return the deposit to the renter."})]})})})]})}),(0,s.jsxs)(x.q,{className:"pt-6",children:[(0,s.jsx)(l.T,{color:"danger",variant:"light",onPress:e,className:"font-medium",children:"Cancel"}),(0,s.jsx)(l.T,{color:N?"primary":"danger",variant:"shadow",className:"font-medium px-8",onPress:R,isLoading:D,children:D?"Processing Deposit...":"Confirm Deposit"})]})]})})})]}):(0,s.jsxs)("div",{className:"w-full max-w-xs text-center",children:[(0,s.jsx)("p",{className:"mb-4 text-default-600",children:"Please connect your wallet to see your boards"}),(0,s.jsx)(l.T,{onPress:F,color:"primary",variant:"shadow",children:"Connect Wallet"})]})}w.displayName="HeroUI.Switch"}},e=>{e.O(0,[729,794,620,427,272,831,823,441,255,358],()=>e(e.s=9192)),_N_E=e.O()}]);