(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[88],{29523:(e,r,t)=>{"use strict";t.d(r,{U:()=>s});var a=t(16620);function s(){return(0,a.createBrowserClient)("https://crejvlwlntwyezdtfofb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNyZWp2bHdsbnR3eWV6ZHRmb2ZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NjIwMzUsImV4cCI6MjA3NDQzODAzNX0.ut1DvOMlPcAz-DoOCyQMWgbQGLWca24u_LOunInrrTU")}},30836:(e,r,t)=>{Promise.resolve().then(t.bind(t,42191))},42191:(e,r,t)=>{"use strict";t.d(r,{default:()=>f});var a=t(95155),s=t(29523),i=t(97282),n=t(85388),l=t(69492),o=t(140),c=t(19876),d=t(96423),u=t(63066),h=t(33099),m=t(4256),p=t(12115),x=t(47647),w=t(20063);function f(){let[e,r]=(0,p.useState)([]),[t,f]=(0,p.useState)(!0),[b,j]=(0,p.useState)(null),[y,g]=(0,p.useState)(null),[N,v]=(0,p.useState)(!1),E=(0,s.U)(),{isOpen:B,onOpen:I,onOpenChange:P}=(0,l.j)(),T=(0,w.useRouter)(),{isConnected:C,account:D,balance:F,connectWallet:S,isLoading:O}=(0,i.v)(),{rentBoard:R}=(0,x.K)(),z=async()=>{if(y){v(!0);try{await R(y.id,y.pricePerDay.toString(),y.deposit.toString());let{error:e}=await E.from("Boards").update({status:2,renter:D}).eq("id",y.id);e&&console.error("Error updating database:",e),P(),g(null)}catch(e){console.error("Rental failed:",e)}finally{v(!1),T.refresh(),(0,m.$U)({title:"Board Rented",description:"Board rented succesfully",color:"success"})}}},H=e=>Number(e.pricePerDay)+Number(e.deposit),k=e=>{if(!F)return!1;let r=H(e);return parseFloat(F)>=parseFloat(r.toString())};return((0,p.useEffect)(()=>{(async()=>{try{f(!0),j(null);let{data:e,error:t}=await E.from("Boards").select("*").eq("status",0);t?(console.error("Fetch error:",t),j("Error fetching boards: ".concat(t.message))):r(e||[])}catch(e){console.error("Unexpected error:",e),j("An unexpected error occurred")}finally{f(!1)}})()},[E]),C)?t?(0,a.jsx)("div",{className:"w-full text-center",children:(0,a.jsx)("p",{children:"Loading available boards..."})}):b?(0,a.jsxs)("div",{className:"w-full text-center text-danger",children:[(0,a.jsx)("p",{children:b}),(0,a.jsx)(n.T,{onPress:()=>window.location.reload(),color:"primary",variant:"bordered",className:"mt-2",children:"Retry"})]}):0===e.length?(0,a.jsx)("div",{className:"w-full text-center",children:(0,a.jsx)("p",{className:"text-default-600",children:"No boards available for rent at the moment."})}):(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Available Surf Boards"}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map((e,r)=>e.owner==D?null:(0,a.jsxs)("div",{className:"p-4 border border-default-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:e.description}),(0,a.jsxs)("div",{className:"text-sm text-default-600 space-y-1",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Price:"})," ",e.pricePerDay," ETH/day"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Deposit:"})," ",e.deposit," ETH"]})]}),(0,a.jsx)(n.T,{color:"primary",variant:"shadow",className:"mt-3 w-full",size:"sm",onPressUp:()=>{g(e),I()},children:"Rent Board"})]},r))}),(0,a.jsx)(o.Y,{isOpen:B,onOpenChange:P,backdrop:"blur",children:(0,a.jsx)(c.g,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.c,{className:"flex flex-col gap-1",children:"Confirm Board Rental"}),(0,a.jsx)(u.h,{children:y&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:y.description}),(0,a.jsxs)("p",{className:"text-sm text-default-600",children:["Owner: ",y.owner.slice(0,6),"...",y.owner.slice(-4)]})]}),(0,a.jsxs)("div",{className:"bg-default-100 p-4 rounded-lg space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Rental Price (1 day):"}),(0,a.jsxs)("span",{className:"font-semibold",children:[y.pricePerDay," ETH"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Security Deposit:"}),(0,a.jsxs)("span",{className:"font-semibold",children:[y.deposit," ETH"]})]}),(0,a.jsx)("hr",{className:"my-2"}),(0,a.jsxs)("div",{className:"flex justify-between text-lg font-bold",children:[(0,a.jsx)("span",{children:"Total Cost:"}),(0,a.jsxs)("span",{className:"text-primary",children:[H(y)," ETH"]})]})]}),(0,a.jsxs)("div",{className:"text-sm text-default-600",children:[(0,a.jsx)("p",{children:"• The rental fee goes directly to the owner"}),(0,a.jsx)("p",{children:"• Your deposit will be returned when you return the board in good condition"}),(0,a.jsx)("p",{children:"• Make sure you have enough ETH in your wallet"})]}),F&&(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{children:"Your Balance: "}),(0,a.jsxs)("span",{className:"font-semibold ".concat(k(y)?"text-success":"text-danger"),children:[F," ETH"]})]})]})}),(0,a.jsxs)(h.q,{children:[(0,a.jsx)(n.T,{color:"danger",variant:"light",onPress:e,children:"Cancel"}),(0,a.jsx)(n.T,{color:"primary",onPress:z,isLoading:N,isDisabled:!y||!k(y),children:N?"Processing...":"Confirm Rental"})]})]})})})]}):(0,a.jsxs)("div",{className:"w-full max-w-xs text-center",children:[(0,a.jsx)("p",{className:"mb-4 text-default-600",children:"Please connect your wallet to rent a board"}),(0,a.jsx)(n.T,{onPress:S,color:"primary",variant:"shadow",children:"Connect Wallet"})]})}},47647:(e,r,t)=>{"use strict";t.d(r,{K:()=>d});var a=t(51012),s=t(16836),i=t(8678),n=t(99794),l=t(17974),o=t(97282),c=t(12115);function d(){let{isConnected:e,account:r}=(0,o.v)(),t=async function(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(console.log("production"),!e||r){let e=new s.FR("https://eth-sepolia.g.alchemy.com/v2/".concat("eLEtvSLC6nhEEel2Fahza"));return new i.NZ(l.m,l.A,e)}let t=(()=>{if(window.ethereum)return new a.k(window.ethereum);throw Error("Ethereum provider not found")})(),n=await t.getSigner();return new i.NZ(l.m,l.A,n)}catch(e){throw console.error("Failed to init contract",e),Error("Failed to initialize contract")}},d=async(e,r,a)=>{let s=await t(),i=n.g5(r),l=n.g5(a),o=await s.rentBoard(e,{value:i+l});await o.wait()};return{withdraw:async()=>{try{let e=await t(),r=await e.withdraw();return{receipt:await r.wait(),contract:e}}catch(e){console.error(e)}},getPendingWithdrawals:async e=>{try{let r=await t();return await r.pendingWithdrawals(e)}catch(e){console.error(e)}},returnDeposit:async(e,r)=>{try{let a=await t(),s=await a.returnDeposit(e.id,r);return{receipt:await s.wait(),contract:a}}catch(e){return{errorMessage:e}}},returnBoard:async e=>{try{let r=await t(),a=await r.returnBoard(e.id);return{receipt:await a.wait(),contract:r}}catch(e){return{errorMessage:e}}},rentBoard:d,listBoard:async(e,r,a)=>{let s,i,l=Number(r),o=Number(a);if(!Number.isFinite(l)||!Number.isFinite(o)||l<0||o<0)return{message:"Price and deposit must be valid positive numbers."};try{s=n.g5(r),i=n.g5(a)}catch(e){return console.error("Failed to parse ETH amounts:",e),{message:"Invalid number format. Use a dot for decimals, e.g., 2.12"}}let c=await t(),d=await c.listBoard(e,s,i);return{receipt:await d.wait(),contract:c}},getAllBoards:(0,c.useCallback)(async()=>{let e=await t(!0),r=await e.nextBoardId(),a=[];console.log("The next board id is: ",r);for(let t=0;t<Number(r);t++)try{let r=await e.boards(t),s={id:Number(r.id),description:r.description,owner:r.owner,renter:r.renter,pricePerDay:r.pricePerDay,deposit:r.deposit,status:Number(r.available)};console.log("board status = ",s.status),a.push(s)}catch(e){console.error("Failed to fetch board ".concat(t,":"),e)}return a},[e]),resetBoards:async()=>{try{let e=await t(),r=await e.resetBoards();return{receipt:await r.wait(),contract:e}}catch(e){return{errorMessage:e}}}}}}},e=>{e.O(0,[729,794,620,427,272,823,441,255,358],()=>e(e.s=30836)),_N_E=e.O()}]);