(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[886],{25763:(e,r,s)=>{Promise.resolve().then(s.bind(s,40924))},29523:(e,r,s)=>{"use strict";s.d(r,{U:()=>a});var t=s(16620);function a(){return(0,t.createBrowserClient)("https://crejvlwlntwyezdtfofb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNyZWp2bHdsbnR3eWV6ZHRmb2ZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NjIwMzUsImV4cCI6MjA3NDQzODAzNX0.ut1DvOMlPcAz-DoOCyQMWgbQGLWca24u_LOunInrrTU")}},40924:(e,r,s)=>{"use strict";s.d(r,{default:()=>g});var t=s(95155),a=s(12115),n=s(29523),l=s(97282),i=s(85388),d=s(69492),o=s(140),c=s(19876),u=s(96423),m=s(63066),x=s(33099),h=s(20063),p=s(47647),f=s(4256);function g(){let[e,r]=(0,a.useState)([]),[s,g]=(0,a.useState)([]),[b,w]=(0,a.useState)(!0),[j,N]=(0,a.useState)(null),[y,v]=(0,a.useState)(null),[k,E]=(0,a.useState)(!1),B=(0,n.U)(),{isOpen:D,onOpen:I,onOpenChange:P}=(0,d.j)(),R=(0,h.useRouter)(),{isConnected:S,account:C,balance:O,connectWallet:T,isLoading:F}=(0,l.v)(),{returnBoard:z}=(0,p.K)();(0,a.useEffect)(()=>{let e=async()=>{try{let e,s;w(!0),N(null);let{data:t,error:a}=await B.from("Boards").select("*").eq("status",2);e=(null==t?void 0:t.filter(e=>e.renter===C))||[],a?(console.error("Fetch error:",a),N("Error fetching boards: ".concat(a.message))):r(e);let{data:n,error:l}=await B.from("Boards").select("*").eq("status",1);console.log(n),s=null==n?void 0:n.filter(e=>e.renter===C),console.log(s),l?(console.error("Fetch error:",l),N("Error fetching boards: ".concat(l.message))):g(s||[])}catch(e){console.error("Unexpected error:",e),N("An unexpected error occurred")}finally{w(!1)}};C&&e()},[B,C]);let U=async()=>{if(y){E(!0);try{z(y);let{error:e}=await B.from("Boards").update({status:1}).eq("id",y.id);e&&(console.error("Error updating database:",e),(0,f.$U)({title:"Error Updating SUPABASE",description:"Unexpected error has occured while updating the database",color:"danger"})),P(),v(null)}catch(e){console.error("Rental failed:",e)}finally{E(!1),R.refresh(),(0,f.$U)({title:"Board Returned",description:"Board returned succesfully",color:"success"})}}};return S?b?(0,t.jsx)("div",{className:"w-full text-center",children:(0,t.jsx)("p",{children:"Loading your boards..."})}):j?(0,t.jsxs)("div",{className:"w-full text-center text-danger",children:[(0,t.jsx)("p",{children:j}),(0,t.jsx)(i.T,{onPress:()=>window.location.reload(),color:"primary",variant:"bordered",className:"mt-2",children:"Retry"})]}):0===e.length&&0===s.length?(0,t.jsx)("div",{className:"w-full text-center",children:(0,t.jsx)("p",{className:"text-default-600",children:"You have no boards :("})}):(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Rented Boards"}),(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 mb-8",children:e.map((e,r)=>(0,t.jsx)("div",{className:"border border-default-200 rounded-lg",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"font-bold text-lg text-foreground mb-3 pr-16",children:e.description}),(0,t.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-default-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-default-600",children:"Daily Price"}),(0,t.jsxs)("span",{className:"font-bold text-foreground",children:[e.pricePerDay," ETH"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-primary-100 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-default-600",children:"Deposit Paid"}),(0,t.jsxs)("span",{className:"font-bold text-primary-500",children:[e.deposit," ETH"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-default-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-default-600",children:"Owner"}),(0,t.jsxs)("span",{className:"font-mono text-sm text-foreground",children:[e.owner.slice(0,6),"...",e.owner.slice(-4)]})]})]}),(0,t.jsx)(i.T,{color:"primary",variant:"shadow",className:"w-full font-medium group-hover:scale-105 transition-transform",size:"lg",onPress:()=>{v(e),I()},children:"Return Board"})]})},r))}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Returned Boards"}),(0,t.jsx)("p",{className:"text-default-600",children:"Boards you've returned"})]}),(0,t.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8",children:s.map((e,r)=>(0,t.jsx)("div",{className:"border border-default-200 rounded-lg",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"font-bold text-lg text-foreground mb-3 pr-20",children:e.description}),(0,t.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-default-50  rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-default-600",children:"Daily Rate"}),(0,t.jsxs)("span",{className:"font-bold text-foreground",children:[e.pricePerDay," ETH"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-warning-50 dark:bg-warning-900/20 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-default-600",children:"Deposit Status"}),(0,t.jsxs)("span",{className:"font-bold text-warning-600 dark:text-warning-400",children:[e.deposit," ETH Deposit"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-default-50 rounded-lg",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-default-600",children:"Owner"}),(0,t.jsxs)("span",{className:"font-mono text-sm text-foreground",children:[e.owner.slice(0,6),"...",e.owner.slice(-4)]})]})]}),(0,t.jsx)("div",{className:"bg-warning-50 dark:bg-warning-900/20 border-warning-100 dark:border-warning-800 rounded-lg p-3",children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("span",{className:"text-sm font-medium text-warning-700 dark:text-warning-300",children:"Successfully returned, waiting for owner"})})})]})},r))}),(0,t.jsx)(o.Y,{isOpen:D,onOpenChange:P,backdrop:"blur",size:"lg",children:(0,t.jsx)(c.g,{children:e=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(u.c,{className:"flex flex-col gap-1 pb-2",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Return Surf Board"}),(0,t.jsx)("p",{className:"text-sm text-default-500",children:"Complete your rental and get your deposit back"})]}),(0,t.jsx)(m.h,{className:"py-6",children:y&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-primary-200 to-secondary-200 p-6 rounded-lg ",children:(0,t.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-foreground mb-1",children:y.description}),(0,t.jsxs)("p",{className:"text-sm text-default-600 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"inline-block w-2 h-2 bg-primary rounded-full"}),"Owner: ",y.owner.slice(0,6),"...",y.owner.slice(-4)]})]})})}),(0,t.jsxs)("div",{className:"bg-default-100 p-6 rounded-xl space-y-4",children:[(0,t.jsx)("div",{className:"flex items-center gap-3 mb-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-foreground",children:"Deposit Return Information"}),(0,t.jsx)("p",{className:"text-sm text-default-600",children:"Your security deposit details"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"p-4 rounded-lg border border-default-200",children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-default-500 mb-1",children:"Daily Rate"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-foreground",children:[y.pricePerDay," ETH"]})]}),(0,t.jsxs)("div",{className:"dark:bg-default-900 p-4 rounded-lg border border-default-200 dark:border-default-700",children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-default-500 dark:text-default-300 mb-1",children:"Security Deposit"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-primary",children:[y.deposit," ETH"]})]})]})]}),(0,t.jsx)("div",{className:"bg-warning-50 border border-warning-200 rounded-xl p-4",children:(0,t.jsx)("div",{className:"flex items-start gap-3",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"font-semibold text-warning-800 dark:text-warning-400 mb-1",children:"Deposit Return Policy"}),(0,t.jsx)("p",{className:"text-sm text-warning-700 dark:text-warning-300",children:"Your deposit will be returned based on the board's condition. Any damages may result in partial deductions from your security deposit."})]})})}),(0,t.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:[(0,t.jsx)("h5",{className:"font-semibold text-blue-800 dark:text-blue-200 mb-3 flex items-center gap-2",children:"What happens next?"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm text-blue-700 dark:text-blue-300",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full"}),(0,t.jsx)("span",{children:"Board return is processed on the blockchain"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full"}),(0,t.jsx)("span",{children:"Owner inspects the board condition"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full"}),(0,t.jsx)("span",{children:"Deposit is returned to your wallet"})]})]})]})]})}),(0,t.jsxs)(x.q,{className:"pt-6",children:[(0,t.jsx)(i.T,{color:"danger",variant:"light",onPress:e,className:"font-medium",children:"Cancel"}),(0,t.jsx)(i.T,{color:"primary",variant:"shadow",className:"font-medium px-8",onPress:U,isLoading:k,children:k?"Processing Return...":"Confirm Return"})]})]})})})]}):(0,t.jsxs)("div",{className:"w-full max-w-xs text-center",children:[(0,t.jsx)("p",{className:"mb-4 text-default-600",children:"Please connect your wallet to see your boards"}),(0,t.jsx)(i.T,{onPress:T,color:"primary",variant:"shadow",children:"Connect Wallet"})]})}},47647:(e,r,s)=>{"use strict";s.d(r,{K:()=>c});var t=s(51012),a=s(16836),n=s(8678),l=s(99794),i=s(17974),d=s(97282),o=s(12115);function c(){let{isConnected:e,account:r}=(0,d.v)(),s=async function(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(console.log("production"),!e||r){let e=new a.FR("https://eth-sepolia.g.alchemy.com/v2/".concat("eLEtvSLC6nhEEel2Fahza"));return new n.NZ(i.m,i.A,e)}let s=(()=>{if(window.ethereum)return new t.k(window.ethereum);throw Error("Ethereum provider not found")})(),l=await s.getSigner();return new n.NZ(i.m,i.A,l)}catch(e){throw console.error("Failed to init contract",e),Error("Failed to initialize contract")}},c=async(e,r,t)=>{let a=await s(),n=l.g5(r),i=l.g5(t),d=await a.rentBoard(e,{value:n+i});await d.wait()};return{withdraw:async()=>{try{let e=await s(),r=await e.withdraw();return{receipt:await r.wait(),contract:e}}catch(e){console.error(e)}},getPendingWithdrawals:async e=>{try{let r=await s();return await r.pendingWithdrawals(e)}catch(e){console.error(e)}},returnDeposit:async(e,r)=>{try{let t=await s(),a=await t.returnDeposit(e.id,r);return{receipt:await a.wait(),contract:t}}catch(e){return{errorMessage:e}}},returnBoard:async e=>{try{let r=await s(),t=await r.returnBoard(e.id);return{receipt:await t.wait(),contract:r}}catch(e){return{errorMessage:e}}},rentBoard:c,listBoard:async(e,r,t)=>{let a,n,i=Number(r),d=Number(t);if(!Number.isFinite(i)||!Number.isFinite(d)||i<0||d<0)return{message:"Price and deposit must be valid positive numbers."};try{a=l.g5(r),n=l.g5(t)}catch(e){return console.error("Failed to parse ETH amounts:",e),{message:"Invalid number format. Use a dot for decimals, e.g., 2.12"}}let o=await s(),c=await o.listBoard(e,a,n);return{receipt:await c.wait(),contract:o}},getAllBoards:(0,o.useCallback)(async()=>{let e=await s(!0),r=await e.nextBoardId(),t=[];console.log("The next board id is: ",r);for(let s=0;s<Number(r);s++)try{let r=await e.boards(s),a={id:Number(r.id),description:r.description,owner:r.owner,renter:r.renter,pricePerDay:r.pricePerDay,deposit:r.deposit,status:Number(r.available)};console.log("board status = ",a.status),t.push(a)}catch(e){console.error("Failed to fetch board ".concat(s,":"),e)}return t},[e]),resetBoards:async()=>{try{let e=await s(),r=await e.resetBoards();return{receipt:await r.wait(),contract:e}}catch(e){return{errorMessage:e}}}}}}},e=>{e.O(0,[729,794,620,427,272,823,441,255,358],()=>e(e.s=25763)),_N_E=e.O()}]);